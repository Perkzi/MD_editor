import{_ as B,r as C,w as D,a as h,o as m,c as k,b as e,d,e as u,u as g,s as te,n as z,f as b,g as F,p as P,h as K,i as R,F as U,j as W,t as A,k as ne,l as H,m as oe,q as N,v as J,x as se,E as L,y as I,z as ae,A as ie}from"./index-f01c7ebf.js";import{C as le}from"./index-da9ce2ab.js";import{s as ce,c as re}from"./index-c788441a.js";import"./index-1b81b294.js";const y=t=>(P("data-v-68e10769"),t=t(),K(),t),de={class:"aside"},ue=y(()=>e("div",{class:"aside-logo"},[e("i",{class:"iconfont icon-circulation"}),e("span",{title:"多人协作编辑器"}," 多人协作编辑器 ")],-1)),_e={class:"aside-search"},pe=y(()=>e("i",{class:"iconfont icon-shouye-zhihui"},null,-1)),me=y(()=>e("span",null," 首页 ",-1)),he=[pe,me],fe=y(()=>e("i",{class:"iconfont icon-zuijinchangyong"},null,-1)),ge=y(()=>e("span",null," 最近文档 ",-1)),ve=[fe,ge],ye=y(()=>e("i",{class:"iconfont icon-shujugongxiang"},null,-1)),xe=y(()=>e("span",null," 与我共享 ",-1)),we=[ye,xe],Ce=y(()=>e("i",{class:"iconfont icon-huishouzhan"},null,-1)),be=y(()=>e("span",null," 回收站 ",-1)),$e=[Ce,be],ke={__name:"aside",props:{activeMenu:{type:String,default:"pages"}},setup(t){const s=C("");D(s,o=>F.commit("setSearchKeyWord",o));const r=o=>b.push(`/home/${o}`);return(o,n)=>{const i=h("el-icon"),l=h("el-input");return m(),k("div",de,[ue,e("div",_e,[d(l,{placeholder:"搜索",modelValue:s.value,"onUpdate:modelValue":n[0]||(n[0]=c=>s.value=c),clearable:""},{prefix:u(()=>[d(i,null,{default:u(()=>[d(g(te))]),_:1})]),_:1},8,["modelValue"])]),e("div",{class:z(["aside-icon",{active:t.activeMenu==="pages"}]),onClick:n[1]||(n[1]=c=>r("pages"))},he,2),e("div",{class:z(["aside-icon",{active:t.activeMenu==="news"}]),onClick:n[2]||(n[2]=c=>r("news"))},ve,2),e("div",{class:z(["aside-icon",{active:t.activeMenu==="share"}]),onClick:n[3]||(n[3]=c=>r("share"))},we,2),e("div",{class:"aside-bottom",onClick:n[4]||(n[4]=c=>g(b).push("/recycle"))},$e)])}}},Se=B(ke,[["__scopeId","data-v-68e10769"]]);const Me={style:{width:"100%",height:"100%"}},Ie={class:"dropdownItem"},Te=["title"],Re={__name:"index",props:{trigger:{type:String,default:"click"},list:{type:Array,default:()=>[]}},emits:["handleCommand","handleOpen","handleClose"],setup(t,{emit:s}){const r=i=>s("handleCommand",i),o=()=>s("handleOpen"),n=()=>s("handleClose");return(i,l)=>{const c=h("el-dropdown-item"),x=h("el-dropdown-menu"),f=h("el-dropdown");return m(),R(f,{trigger:t.trigger,onHandleOpen:o,onHandleClose:n,onCommand:r},{dropdown:u(()=>[d(x,null,{default:u(()=>[(m(!0),k(U,null,W(t.list,_=>(m(),R(c,{key:_.command,command:_.command},{default:u(()=>[e("div",Ie,[e("i",{class:z(["iconfont",_.icon])},null,2),e("span",{title:_.name},A(_.name),9,Te)])]),_:2},1032,["command"]))),128))]),_:1})]),default:u(()=>[e("div",Me,[ne(i.$slots,"content",{},void 0,!0)])]),_:3},8,["trigger"])}}},ze=B(Re,[["__scopeId","data-v-b30e786d"]]),Be=(t,s,r="Typora")=>new Promise((o,n)=>{if(t.name.split(".")[1]==="md"){let l=new FileReader;l.readAsText(t,"UTF-8"),l.onloadend=async c=>{c.target.readyState!==2&&n({msg:"文件读写失败"});let x=Oe(c.target.result.toString().split(`
`)),{userid:f}=JSON.parse(sessionStorage.getItem("user")),_=await ce({fileid:s,userid:f,content:x});_.code!==200&&n(_),o(_)}}});function Oe(t,s){let r=[];return t.forEach(o=>{let n=o&&o.match(/^[#]+|[*]+[\u4e00-\u9fa5|\d|a-z|A-Z|-]|[~~~]{3}|[<][u][>]|[\]][(]/g);if(!n)return r.push({insert:j(o)});let i=null;n.forEach(l=>{l.toString().includes("#")&&(i=l.length)}),r.push({insert:j(o),attributes:{header:i}})}),JSON.stringify(r)}function j(t){return t.replace(/[']/g,"#[d]#").replace(/["]/g,"#[s]#").replace(/^#+/g,"")}const v=t=>(P("data-v-6579e611"),t=t(),K(),t),Ve={class:"top-left"},Ne=v(()=>e("i",{class:"iconfont icon-xinjian"},null,-1)),Fe=v(()=>e("span",null,"新建",-1)),He=v(()=>e("i",{class:"iconfont icon-daoru"},null,-1)),Ae=v(()=>e("span",null,"导入",-1)),Ee=v(()=>e("i",{class:"iconfont icon-duqumoban"},null,-1)),qe=v(()=>e("span",null,"模板",-1)),Je=v(()=>e("i",{class:"iconfont icon-gongneng"},null,-1)),Le=v(()=>e("span",null,"工具箱",-1)),je={class:"top-right"},De={class:"top-right-vip"},Pe=v(()=>e("i",{class:"iconfont icon-zuanshi"},null,-1)),Ke={class:"top-right-message",style:{"margin-right":"20px"}},Ue=v(()=>e("i",{class:"iconfont icon-xiaoxizhongxin"},null,-1)),We={class:"top-right-user"},Ze=["innerHTML"],Ge={key:2,class:"iconfont icon-tipvip"},Qe={__name:"top",setup(t){const s=C("【双十一】超值活动，会员低至0.5元/天！");let r=C(!0),o=C("");const n=H([{name:"个人中心",command:"user",icon:"icon-zhanghao"},{name:"系统设置",command:"setting",icon:"icon-shezhi-xianxing"},{name:"项目地址",command:"gitee",icon:"icon-github-fill"},{name:"退出系统",command:"exit",icon:"icon-tuichu"}]),i=H({show:!1}),l=a=>{switch(a){case"user":b.push("/user");break;case"gitee":window.open("https://gitee.com/wfeng0/mpoe");break;case"setting":i.show=!0;break;case"exit":sessionStorage.clear(),b.push("/login");break}},c=()=>b.push("/template");let x=C(null),f=C(!1);const _=async a=>{f.value=!0,await se(),x.value.showContentMenu(a,!0)},Z=()=>f.value=!1,G=a=>F.commit("setTopCreateData",a);let O=C(null);const Q=async a=>{const p=a.target.files[0];try{await L.confirm(`确认上传 ${p.name} 进行协同吗？`,"文件上传",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}),X(p)}catch{I.info("已取消")}O.value.value=""},X=async a=>{let p=JSON.parse(sessionStorage.getItem("user")).userid,w=a.name.split(".")[0],$=a.name.split(".")[1],T={md:"markdown",txt:"txt",doc:"word",docx:"word",xls:"excel",xlsx:"excel"}[$],S=b.currentRoute.value.query.folderid,Y=Math.random().toString().split(".")[1].slice(0,3),M=await re({userid:p,filename:w,filesuffix:$,filetype:T,fileownerfolderid:S});if(M.code!==200)return I.error("导入失败，"+M.msg);I.success("文件导入成功！");let ee={id:M.data,name:Y,suffix:$,type:T};F.commit("setTopCreateData",ee);let V=await Be(a,M.data,"Typora");if(V.code!==200)return I.error(V.msg);I.success(V.msg);try{await L.confirm("是否立即打开文件？","打开文件",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"});let q={filename:w,filesuffix:$,filetype:T,owner:p};b.push({path:$==="xlsx"?`/excel/${M.data}`:`/edit/${M.data}`,query:q})}catch{I.info("已取消")}};return oe(()=>{let a=JSON.parse(sessionStorage.getItem("user"));r.value=a.vip,o.value=a.userimg}),(a,p)=>{const w=h("el-button"),$=h("el-link"),E=h("el-badge"),T=h("el-avatar");return m(),k("div",{class:"top",onClick:p[2]||(p[2]=N((...S)=>a.hiddenContentMenu&&a.hiddenContentMenu(...S),["stop"]))},[e("div",Ve,[d(w,{type:"primary",onClick:p[0]||(p[0]=N(S=>_(S),["stop"]))},{default:u(()=>[Ne,Fe]),_:1}),d(w,{text:"",onClick:p[1]||(p[1]=N(S=>g(O).click(),["stop"]))},{default:u(()=>[He,Ae]),_:1}),d(w,{text:"",onClick:c},{default:u(()=>[Ee,qe]),_:1}),d(w,{text:""},{default:u(()=>[Je,Le]),_:1})]),e("div",je,[e("div",De,[d($,{type:"danger"},{default:u(()=>[Pe,e("span",null,A(s.value),1)]),_:1})]),e("div",Ke,[d(E,{value:"",class:"item"},{default:u(()=>[Ue]),_:1})]),e("div",We,[d(ze,{list:n,onCommand:l},{content:u(()=>[g(o)?(m(),k("div",{key:0,class:"userimg_svg",innerHTML:g(o)},null,8,Ze)):(m(),R(T,{key:1,shape:"square",src:"https://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png"})),g(r)?(m(),k("i",Ge)):J("",!0)]),_:1},8,["list"])])]),g(f)?(m(),R(le,{key:0,ref_key:"contentmenuRef",ref:x,onCreate:G,onClose:Z},null,512)):J("",!0),e("input",{type:"file",onChange:Q,style:{display:"none"},accept:"*",ref_key:"inputRef",ref:O},null,544)])}}},Xe=B(Qe,[["__scopeId","data-v-6579e611"]]);const Ye={class:"home"},et={class:"home-main"},tt={__name:"index",setup(t){let s=H([{title:"首页",path:"/home/pages"}]),r=[{path:"news",title:"最近文档"},{path:"share",title:"与我共享"}],o=C("pages");return D(b.currentRoute,n=>{let i=n.path.split("/")[2];o=i;let l=r.find(c=>c.path===i);s.length===1&&i==="pages"||(s.length>1&&s.pop(),l&&s.push({title:l.title,path:`/home/${l.path}`}))},{deep:!0,immediate:!0}),(n,i)=>{const l=h("el-breadcrumb-item"),c=h("el-breadcrumb"),x=h("router-view");return m(),k("div",Ye,[d(Se,{activeMenu:g(o)},null,8,["activeMenu"]),e("div",et,[d(Xe),d(c,{class:"home-main-bread","separator-icon":g(ie)},{default:u(()=>[(m(!0),k(U,null,W(g(s),(f,_)=>(m(),R(l,{key:_,to:{path:f.path}},{default:u(()=>[ae(A(f.title),1)]),_:2},1032,["to"]))),128))]),_:1},8,["separator-icon"]),d(x,{style:{flex:"auto",padding:"10px 20px"}})])])}}},it=B(tt,[["__scopeId","data-v-5edbf6fb"]]);export{it as default};
